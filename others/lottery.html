
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" /> 
<title>LOTTERY</title>
<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css">
<script src="https://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    
</head>
    
	<body>
        <div class="container" style="margin-top:30px">
                    <div class="form-group">
                        <label for="name">CANDIDATES</label>
                        <textarea id="candidates" class="form-control" rows="10">
1	Mcgrady
3	Iverson
5	Garnett
11	Yao
14	Nowitzki
15	Anthony
21	Duncan
23	James
24	Kobe
34	O'Neal</textarea>
                    </div>
                    <form class="form-inline" style="margin-bottom:10px">
                        <div class="form-group">
                            <label for="ct">LIMIT</label>
                            <input id="cont" type="text" class="form-control" id="ct" value="3">
                        </div>
                        <button type="button" id="btn" class="btn btn-primary">START</button>
                        <button type="button" id="btn-stop" class="btn btn-danger">STOP</button>
                    </form>
                    <div class="form-group">
                        <label for="name">WINNERS</label>
                        <textarea id="finals" class="form-control" rows="10"></textarea>
                    </div>
                
        </div>            
</body>
<script type="text/javascript">
    
    var stop_loop = false;
    
    function getRandomArrayElements(arr, count) {
        var shuffled = arr.slice(0), i = arr.length, min = i - count, temp, index;
        while (i-- > min) {
            index = Math.floor((i + 1) * Math.random());
            temp = shuffled[index];
            shuffled[index] = shuffled[i];
            shuffled[i] = temp;
        }
        return shuffled.slice(min);
    }
    
    function getRandomColor(){
        return '#' +
		(function(color) {
			return(color += '5678956789defdef' [Math.floor(Math.random() * 16)]) &&
				(color.length == 6) ? color : arguments.callee(color);
		})('');
    }
    
    function getWinners(can_list, limit) {
        var winners = getRandomArrayElements(can_list, limit);
        $("#finals").val(winners.join("\n"));
        $("#cont").css({'background' : getRandomColor()})
        if(stop_loop) {
            $("#cont").removeAttr("style","");
            return;
        }
        setTimeout(getWinners, 500, can_list, limit);
    }
    
    $("#btn").click(function(event){
        console.log("start")
        stop_loop=false;
        var candidates = $("#candidates").val();
        console.log(stop_loop);
        var can_list = candidates.split("\n");
        var limit = $("#cont").val();
        
        getWinners(can_list, limit);
        
    });
    
    $("#btn-stop").click(function(event){
        stop_loop = true;
        console.log("end")
    });
    
</script>
</html>
